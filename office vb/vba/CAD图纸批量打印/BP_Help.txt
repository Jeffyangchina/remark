模型空间的批量打印程序 第二版(2.9.1)
秋枫，2005年2月24日

程序简介：

    这是一个为AutoCAD2000以上版本设计的模型空间批量打印程序。程序根据自己判定的图框位置与尺寸，根据当前的打印机设置，自动调整打印的方式，实现批量打印。

免责声明：本程序仅提供作为应用上的参考, 而未声明或隐含任何保证；对于任何特殊用途之适应性, 以及商业销售所隐含作出的保证, 在此一概予以否认。

拒绝担保：拒绝任何责任担保，因使用该程序所致的全部风险及后果均由用户自己承担。

更新历史：

修正调试程序时的一个疏忽，把有用的代码注释掉了导致不能选取图块（7月22日）2.9.1 
支持除理正图框层外的其它图层上的图框（封闭矩形PLINE）6月29日 
支持反向打印（图纸旋转180度）6月29日 
理正图框支持“*_TITLE”6月29日 
添加支持“理正电气(ELE_TITLE)”图层的图框。(4月8日) 
修正“在布局空间中强制使用模型空间线型比例”选项不起作用的问题(程序中笔误)(4月8日) 
因DCS与UCS不一致而产生的Bug，Target系统变量（2005.2.24） 
在状态栏显示比例与进度信息(7月5日) 
BUGFIX: 图块列表(7月5日) 
提供打印多个Layout的功能（7月1日） 
打印不出图框边线问题（6月30日） 
在DWG文件中保存上次的批量打印设置（6月28日） 
增加打印顺序调整功能（6月25日） 
自动打印比例算法调整（6月25日） 
支持在UCS下的图块图框（6月25日） 
自动旋转设为可选。如选成不自动，可以在页面设置中调整方向（6月25日） 
支持在UCS下的理正图框（6月24日） 
2.2版。增加图纸偏移与居中选项（6月9日） 
增加了一个打印份数的选项。 
加入打印机驱动或打印机不存在时的出错处理。 
第二版全面改写，新增对话框。 
加入对理正图框的支持。 
第一版。 
使用说明：

¨         图框：图框的判断方式

e        理正图框：判断依据――――在图层PUB_TITLE中的4个顶点的零宽度闭合多义线，程序就认为是理正的图框。如果是用户自定的PLINE图框，也可以把它们移到PUB_TITLE层中让程序自动选择过滤。

e        图块：这种情况，图框是图块。程序根据用户提供的数据判定。

¨         图块：图框为图块时的判断设置。可以从下列表中指定一个图块名告诉程序图框的图块名，或者用“拾取”按钮从图中点取一个图块样本指定图框。

¨         输出方式：提供了3种输出方式。

e        直接 批量打印，即以当前设置输出到打印机

e        批量生成布局。根据所选的图框生成布局，以后就无需模型空间批量打印程序了。可以使用标准的PLOT命令，打印所选择的布局。

e        生成PLT文件。根据设定生成。

e        打印已有布局。 以显示的标签顺序打印全部或选择的布局。这个命令比AutoCAD2005的Publish命令节省内存。有时在Publish命令无法正常工作时可以作为部分功能的替代。

¨         选择批量打印图纸：这是最主要的一步。从图中选择图框，自动过滤非图框物体。当没有任何图纸选中时，预览与确定两个按钮是灰显不可用的。命令启动时自动记忆上次批量打印选择的图框。

¨         亮显: 在图中以红色虚线框加叉表示当前选中的图纸。

¨         打印设置：使用AutoCAD的页面设置命令对当前打印机、当前纸张大小、当前打印样式表进行设定。最后请点击“确定”或“OK”回到主对话框。无需设定窗选范围，居中打印，打印比例、旋转等等，因为本程序会根据选中的各个图纸的不同情况自动设定。

e        预设配置：用户可以从列表中选择一个预设配置。添加／删除／编辑预设配置列表在“打印设置..”对话框页面设置栏中点“添加(Add)”修改。

e        份数：打印份数会自动记忆上次的打印份数，因此打印前请小心设置，确认份数，以免多印。 　 

¨         打印比例：

e        自动比例：图纸大小与图框外轮廊线匹配，并对比例自动取整（一般建筑中用的整数比例），即允许图框有点误差，如果计算出比例为1:199.6之类的数值，自动取为1:200

e        适合图纸：图纸可打印区域与图框外轮廊线匹配，这样可以打印出外轮廓线。相当于AutoCAD标准比例中的"Scale To Fit"

e        固定比例：对所有选中的图纸使用指定的固定比例。需用户手动输入比例值。

¨         图纸定位：

e        自动旋转：打印时自动 根据图框形状与纸张决定是否旋转90度打印。

e        自动 居中打印：打印时自动居中打印。

e        偏移：同AutoCAD标准Plot命令。需手动输入X, Y方向的偏移数值。

¨         打印顺序：

e        按选择顺序：打印时按照在屏幕上选择图框时的顺序打印。

e        左→右，上→下：按先左右后上下的顺序打印。

e        上→下，左→右：按先上下后左右的顺序打印。

e        逆序：按前面设定的顺序的反向顺序打印。

¨         打印文件：生成PLT文件时的设置。

e        文件名前缀：批量生成打印文件时文件名前缀，后面程序自动编号。如，文件名前缀为"BP_", 生成的PLT文件则依次为: "BP_01.plt", "BP_02.plt", ...默认是当前的DWG文件名加"_"

e        删除已有同前缀名的PLT文件。生成PLT文件前把目标目录的同前缀名的PLT文件删除。

e        保存位置：PLT保存的位置。默认为当前DWG文件位置。

¨         布局设置：批量生成布局时的设置

e        布局名前缀：批量生成布局时布局名称前缀，后面程序自动编号。如，前缀为"BP_", 生成的布局名则依次为: "BP_01", "BP_02", ...默认是"BP_"

e        删除已有同前缀名的布局。生成布局前把当前文件中同缀名的布局删除。

e        在布局中强制使用图纸空间的线型比例。这一项选中后，在生成的布局中打印也将使用模型空间的显示线型比例。

¨         预览：依次预览各图

¨         确定：开始批量打印／生成布局／生成PLT文件

¨         取消：退出。

¨         帮助：显示本文。
